# 二项分布

适用的条件

每次实验结果只有发生和不发生两种情形(如成功/失败)，且每次实验中，成功/失败事1. 件发生的概率都相同
2. 重复实验是相互独立



## 二项分布的应用

利用二项分布及其正态近似性，可进行总体率的区间估计和差异推断，也可用于研究非遗传性疾病的家族集聚性和做群检验。对于二分类事物的构成问题，对其中一类的构成比进行统计推断，其方法则类似总体率。
###  总体率的估计

####  精确法

对于n≤50的小样本资料，用查表法可以获取百分率的可信区间，即了得到其总体的1-α(α一般取0.05，或0.01)的可信区间。

R语言中的二项分布相关的函数与之前介绍的连续性分布(u分布，t分布和f分布)类似，主要有 dbinom(),pbinom(),qbinom()和rbinom()。 用于进行参数估计和假设检验的函数主要有binom.test()。


    若A发生的概率为0.3，则dbinom(20,100,0.3)表示进行100次试验A出现20次的概率；sum(dbinom(20:60,100,0.3))表示出现20—60次的概率。

    pbinom(q, size, prob)：<=q的事件累积概率

    1-pbinom(q, size, prob)：>=q的事件累积概率

    qbinom(p, size, prob)：累积概率p对应的q 

    其中，x,q指实验结果（出现成功的次数），size指试验的次数，prob指成功的概率，p为累计概率。


使用《医学统计学》中的 案例6-2 的数据在R中进行二项分布的精确法/查表法分析测试

```{r}
n <- 13
x <- 6
ratio <- x/n
binom.test(x, n, p = 0.5)
binom.test(x, n, p = 0.5, alternative = "two.sided", conf.level = 0.95)
#install.packages("Hmisc")
library(Hmisc)
library(Hmisc)
binconf(x, n, alpha=0.05, method="all")
```

#### 正态近似法

果n足够大，那么二项分布的偏度就比较小。在这种情况下，如果使用适当的连续性校正， 那么B(n,p)的一个很好的近似是正态分布:N(np,np(1-p))，对应的样本率p也近似正态分布: N(p,p(1-p)/n)。当n越大（至少20）且p不接近0或1时近似效果更好。 不同的经验法则可以用来决定n是否足够大，以及p是否距离0或1足够远， 其中一个常用的规则是np和n(1 −p)都必须大于5时，可利用样本率p的分布近似正态分布来估计总体的1-α(α=0.05或0.01)的可信区间


使用《医学统计学》中的 案例6-3 的数据在R中进行二项分布的正态近似法分析测

```{r}
##用正态分布近似计算
n1 <- 100
x1 <- 55
p1 <- x1/n1
S_p1=sqrt(p1*(1-p1)/n1)
p1 + c(-1, 1)*qnorm(0.975)*S_p1
##用精确法计算
binom.test(x1, n1, 0.5, alternative="two.sided", conf.level=0.95)
#使用Hmisc包中的binconf()函数
binconf(x1, n1, alpha=0.05, method="all")
           
           
```






















